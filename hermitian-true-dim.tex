%  LaTeX support: latex@mdpi.com 
%  For support, please attach all files needed for compiling as well as the log file, and specify your operating system, LaTeX version, and LaTeX editor.

%=================================================================
\documentclass[entropy,article,submit,pdftex,moreauthors]{Definitions/mdpi} 

%=================================================================
% MDPI internal commands - do not modify
\firstpage{1} 
\makeatletter 
\setcounter{page}{\@firstpage} 
\makeatother
\pubvolume{1}
\issuenum{1}
\articlenumber{0}
\pubyear{2024}
\copyrightyear{2024}
%\externaleditor{Academic Editor: Firstname Lastname}
\datereceived{ } 
\daterevised{ } % Comment out if no revised date
\dateaccepted{ } 
\datepublished{ } 
%\datecorrected{} % For corrected papers: "Corrected: XXX" date in the original paper.
%\dateretracted{} % For corrected papers: "Retracted: XXX" date in the original paper.
\hreflink{https://doi.org/} % If needed use \linebreak
%\doinum{}
%\pdfoutput=1 % Uncommented for upload to arXiv.org
%\CorrStatement{yes}  % For updates


%=================================================================
% Add packages and commands here. The following packages are loaded in our class file: fontenc, inputenc, calc, indentfirst, fancyhdr, graphicx, epstopdf, lastpage, ifthen, float, amsmath, amssymb, lineno, setspace, enumitem, mathpazo, booktabs, titlesec, etoolbox, tabto, xcolor, colortbl, soul, multirow, microtype, tikz, totcount, changepage, attrib, upgreek, array, tabularx, pbox, ragged2e, tocloft, marginnote, marginfix, enotez, amsthm, natbib, hyperref, cleveref, scrextend, url, geometry, newfloat, caption, draftwatermark, seqsplit
% cleveref: load \crefname definitions after \begin{document}


\usepackage{mathrsfs}

\newtheorem{Conjecture}{Conjecture}%[section]

\DeclareMathOperator{\ev}{ev}
\DeclareMathOperator{\trace}{Tr}
\newcommand{\Supp}{\operatorname{Supp}}
\newcommand{\Div}{\operatorname{Div}}
\newcommand{\Frob}{{\mathrm{Fr}_{q^2}}}
\newcommand{\g}{\mathfrak{g}}

%=================================================================
% Please use the following mathematics environments: Theorem, Lemma, Corollary, Proposition, Characterization, Property, Problem, Example, ExamplesandDefinitions, Hypothesis, Remark, Definition, Notation, Assumption
%% For proofs, please use the proof environment (the amsthm package is loaded by the MDPI class).

%=================================================================
% Full title of the paper (Capitalized)
\Title{On the dimension of Hermitian subfield subcodes from higher degree place}

% MDPI internal command: Title for citation in the left column
\TitleCitation{Title}

% Author Orchid ID: enter ID or remove command
\newcommand{\orcidauthorA}{0000-0000-0000-000X} % Add \orcidA{} behind the author's name
%\newcommand{\orcidauthorB}{0000-0000-0000-000X} % Add \orcidB{} behind the author's name


%Institute of Mathematics, Budapest University of Technology and Economics, M\H{u}egyetem rkp. 3, H-1111 Budapest, Hungary.}

% Authors, for the paper (add full first names)
\Author{Sabira El Khalfaoui $^{1,\dagger}$\orcidA{0000-0002-1792-2947} and G\'{a}bor P. Nagy$^{2,\dagger}$\orcidA{0000-0002-9558-4197}}

%\longauthorlist{yes}

% MDPI internal command: Authors, for metadata in PDF
\AuthorNames{Sabira El Khalfaoui and G\'{a}bor P. Nagy}

% MDPI internal command: Authors, for citation in the left column
\AuthorCitation{El Khalfaoui, S.; Nagy, G.P.}
% If this is a Chicago style journal: Lastname, Firstname, Firstname Lastname, and Firstname Lastname.

% Affiliations / Addresses (Add [1] after \address if there is only one affiliation.)
\address{%
$^{1}$ \quad Univ Rennes, IRMAR - UMR 6625, F-35000 Rennes, France; sabiraelkhalfaoui@gmail.com\\
$^{2}$ \quad Bolyai Institute, University of Szeged, Aradi v\'{e}rtan\'{u}k tere 1, H-6720 Szeged, Hungary; and  HUN-REN-ELTE Geometric and Algebraic Combinatorics Research Group, P\'azm\'any P\'eter s\'et\'any 1/C, H-1117 Budapest, Hungary; nagyg@math.u-szeged.hu}

% Contact information of the corresponding author
\corres{Correspondence: sabiraelkhalfaoui@gmail.com (S.E.K.)}

% Current address and/or shared authorship
%\firstnote{Current address: Affiliation 3.} 
\secondnote{These authors contributed equally to this work.}
% The commands \thirdnote{} till \eighthnote{} are available for further notes

%\simplesumm{} % Simple summary

%\conference{} % An extended version of a conference paper

% Abstract (Do not insert blank lines, i.e. \\) 
\abstract{The focus of our research is the examination of Hermitian curves over finite fields, specifically concentrating on places of degree 3 and their role in constructing Hermitian codes. We begin by studying the structure of the Riemann-Roch space associated with these degree 3 places, aiming to determine essential characteristics such as the basis. The investigation then turns to Hermitian codes, where we analyze both functional and differential codes of degree 3 places, focusing on their parameters and automorphisms. In addition, we explore the study of subfield subcodes and trace codes, determining their structure by giving lower bounds for their dimensions. This presents a complex problem in coding theory. Based on numerical experiments, we formulate a conjecture for the dimension of some subfield subcodes of Hermitian codes. 
Our comprehensive exploration seeks to deepen the understanding of Hermitian codes and their associated subfield subcodes related to degree 3 places, thus contributing to the advancement of algebraic coding theory and code-based cryptography.}

% Keywords
\keyword{Hermitian curves; degree 3 places; Riemann-Roch space; hermitian codes; subfield subcodes; automorphisms of Hermitian codes} 

% The fields PACS, MSC, and JEL may be left empty or commented out if not applicable
%\PACS{J0101}
%\MSC{}
%\JEL{}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\section{Introduction}

The advent of quantum computers presents significant threats to classical cryptographic schemes, which needs the development of post-quantum cryptographic primitives that resist quantum attacks. In this regard, Algebraic-Geometry (AG) codes have gained considerable attention due to their error-correcting capabilities and potential applications in secure communication and cryptographic protocols. Among various classes of AG codes, subfield subcodes that stand out against structural attacks, making them good candidates for deployment in post-quantum cryptography.



Within linear codes over finite field extensions, the process of generating subfield subcodes, commonly referred to as restriction, entails converting a given linear code $C$ over a large field extension $\mathbb{F}_{q^n}$ into a code that is defined over a subfield $\mathbb{F}_{q^m}$, where $m$ divides $n$. This strategic approach restricts the codewords of $C$ to elements found within the smaller field $\mathbb{F}_{q^m}$, effectively concealing the details about the structure inherent in $C$. A classic example of this concept is the Reed-Solomon codes, which are algebraic geometry (AG) codes constructed over a projective line. They are widely used in practical applications, with their subfield subcodes represented by Goppa codes. In particular, in cryptography, especially within the McEliece cryptosystem, subfield subcodes play a crucial role in hiding the code structure, thus enhancing its resilience against distinguisher attacks \cite{sendrier2002security, faugere2013distinguisher}. The long-lasting security of the McEliece cryptosystem based on Goppa codes \cite{mceliece1978public}, emphasizes its effectiveness in preventing such attacks. Despite subsequent proposals exploring Reed-Solomon codes \cite{couvreur2014distinguisher}, AG codes, and their subcodes \cite{couvreur2017cryptanalysis}, all have been susceptible to structural attacks. By imposing restrictions, cryptographic systems can enhance their security by minimizing the risk of potential attacks aimed at distinguishing the chosen subfield subcode. With growing interest in AG codes, particularly Hermitian codes, they are being evaluated as feasible alternatives to Reed-Solomon codes in specific applications \cite{macdonald2003hermitian}. Hermitian codes have been extensively studied in prior research \cite{stichtenoth1988note, little1997structure, yang1992true, korchmaros2019codes, ren2004structure, lhotel2023goppa}, particularly those associated with the point at infinity of the Hermitian curve. However, in \cite{korchmaros2013hermitian, matthews2005one}, authors introduced an alternative construction of Hermitian codes associated with higher-degree places on the Hermitian curve.


Our contribution involves conducting further research on Hermitian codes associated with degree $3$ places, and derive additional properties and establish explicit bases for the corresponding Riemann-Roch spaces, additionally, this should align with previous findings in \cite{korchmaros2013hermitian}. These codes have improved minimum distances, as shown by the Matthews-Michel bound \cite{matthews2005one}, and have been further strengthened by Korchm'aros and Nagy in \cite{korchmaros2013hermitian}. Moreover, we explore the properties of their subfield subcodes. Our investigation particularly emphasizes the determination of their true dimensions. The family of subfield subcodes of Hermitian codes associated with degree $3$ places holds promise for the construction of an improved and secure McEliece cryptosystem. This implies that such a proposal could reduce the key size and achieve the security level required by NIST \cite{Nist}.


The paper is structured as follows. In Section \ref{sec} we introduce the essential background of AG codes constructed from the Hermitian curve, including Hermitian curves, divisors, and the Riemann-Roch space. In Section \ref{sec:geometry}, we provide some facts on degree 3 places on the Hermitian curve, in particular, we study their geometric properties and algebraic presentations. Section \ref{sec:riemann-roch} deals with their corresponding Riemann-Roch spaces, where we explore their structure and give explicit and practical bases. In Section \ref{sec:Herm}, we study the functional and differential Hermitian codes of degree 3 place where we introduce a new construction. Moreover, we discuss some results on their equivalence under certain transformations. In Section \ref{sec:subf}, we give the main result on the dimension of the subfield subcodes of degree 3 place Hermitian codes. This result consists of a theorem that provides a lower bound on the dimension of the underlying codes, while the conjecture suggests a possible equality based on numerical experiments. 


\section{Algebraic Geometry (AG) codes \label{sec}}

\subsection{Hermitian curves and their divisors}

For more details, we refer the reader to \cite{stichtenoth2009algebraic, stepanov2012codes,cossidente1999curves}. The Hermitian curve, denoted as $\mathscr{H}_q$, over the finite field $\mathbb{F}_{q^2}$ in affine coordinates is given by the equation:
\[
	\mathscr{H}_q: Y^q + Y = X^{q+1}.
\]
This curve has a genus $g = \frac{q(q-1)}{2}$, classifying it as a maximal curve because it achieves the maximum number of $\mathbb{F}_{q^2}$-rational points, which is $\#\mathscr{H}_q(\mathbb{F}_{q^2}) = q^3 + 1$. Furthermore, $\mathscr{H}_q$ has a unique point at infinity, denoted $Q_{\infty}$.

A divisor on $\mathscr{H}_q$ is a formal sum $D = n_1 Q_1 + \cdots + n_k Q_k$ where $n_1, \cdots, n_k$ are integers and $Q_1, \cdots, Q_k$ are points on $\mathscr{H}_q$. The degree of the divisor $D$ is defined as $\deg(D) = \sum_{i=1}^k n_i$. The valuation of $D$ at a point $Q_i$ is $v_{Q_i}(D) = n_i$, and the support of $D$ is the set $\{ Q_i \mid n_i \neq 0 \}$.

The Frobenius automorphism, denoted as $\text{Fr}_{q^2}$, is defined over the algebraic closure $\overline{\mathbb{F}}_{q^2}$ and acts on elements as follows:
\[
	\text{Fr}_{q^2}: \overline{\mathbb{F}}_{q^2} \to \overline{\mathbb{F}}_{q^2}, \quad x \mapsto x^{q^2}.
\]
It acts on the points of $\mathscr{H}_q$ by applying $\text{Fr}_{q^2}$ to their coordinates. A point $Q$ on $\mathscr{H}_q$ is $\mathbb{F}_{q^2}$-rational if and only if it is fixed by $\text{Fr}_{q^2}(Q)$. Over $\overline{\mathbb{F}}_{q^2}$, the points in $\mathscr{H}_q$ correspond one-to-one with the places in the function field $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$.

For a divisor $D$, its Frobenius image is given by
\[
	\text{Fr}_{q^2}(D) = n_1 \text{Fr}_{q^2}(Q_1) + \cdots + n_k \text{Fr}_{q^2}(Q_k).
\]
$D$ is $\mathbb{F}_{q^2}$-rational if $D = \text{Fr}_{q^2}(D)$. In particular, if all points $Q_1, \ldots, Q_k$ are in $\mathscr{H}_q(\mathbb{F}_{q^2})$, then $D$ is inherently $\mathbb{F}_{q^2}$-rational.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Riemann-Roch spaces}

For a non-zero function $g$ in the function field $\overline{\mathbb{F}}_{q^2}$ and a place $P$, $v_P(g)$ stands for the order of $g$ at $P$. If $v_P(g) > 0$ then $P$ is a zero of $g$, while if $v_P(g) < 0 $,then $P$ is a pole of $g$ with multiplicity $-v_P(g)$. The principal divisor of a non-zero function $g$ is $(g)= \sum_{P}v_P(g) P$.

The \emph{Riemann--Roch space} associated with an  $\mathbb{F}_{q^2}$-rational divisor $G$ is the $\mathbb{F}_{q^2}$ vector space 
\[\mathscr{L}(G) := \{g \in \mathbb{F}_{q^2}(\mathscr{H}_q) \mid (g) + G \geq 0\} \cup {0}.\] 

From \cite[Riemann's Theorem~1.4.17]{stichtenoth2009algebraic}, we have 
\[\dim\mathscr{L}(G) \geq \deg(G) +1 - \mathfrak{g},\] 
with equality if $\deg(G) \geq 2\mathfrak{g}-1$.

In this work, our primary focus is on an $\mathbb{F}_{q^2}$-rational divisor $G$ of the form $ sP$ where $P$ is a degree $r$ place in $\mathbb{F}_{q^2}(\mathscr{H}_q)$ and $s$ is a positive integer. In the extended constant field $\mathbb{F}_{q^6}(\mathscr{H}_q)$ of $\mathbb{F}_{q^2}(\mathscr{H}_q)$ with degree $r$, let $P_1, P_2, \cdots, P_r$ be the extensions of $P$. These points are degree-one places in $\mathbb{F}_{q^{2r}}(\mathscr{H}_q)$, and, appropriately labeling the indices, $P_{i} = \text{Fr}^i_{q^2}(P_1)$, where the indices are considered modulo $r$.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Hermitian codes}
Here, we outline the construction of an AG code from the Hermitian curve.


In algebraic coding theory, Hermitian codes stand out as a significant class of algebraic geometry (AG) codes, renowned for their distinctive properties. These codes are constructed from Hermitian curves defined over finite fields. These codes are typically viewed as functional AG codes, denoted by $C_{\mathcal{L}}(D, G)$. In this standard approach, the divisor $G$ is usually a multiple of a single place of degree one. The set $\mathcal{P}$, which encompasses all the rational points in $\mathscr{H}_q$, is listed as $\{Q_1, \ldots, Q_{n}\}$. This approach gives rise to a structure known as a one-point code. However, it is important to note that recent research in the field suggests that the use of a more varied selection for the divisor $G$ can result in the creation of better AG codes \cite{matthews2005one,korchmaros2013hermitian}.



Given a divisor $D=Q_1+Q_2+\cdots+Q_n$ where all $Q_i$ are distinct rational points, and an $\mathbb{F}_{q^2}$-rational divisor $G$ such that $\Supp(G) \cap \Supp(D) = \emptyset$. By numbering the places in the support of $D$, we define an evaluation map $\ev_{D}$ such that $\ev_{D}(g) = (g(Q_1),\dots,g(Q_n))$ for $g \in \mathscr{L}(G)$. 


The functional AG code associated with the divisor $G$ is
\[C_{\mathcal{L}}(D,G) := \{(g(Q_1),g(Q_2),\cdots,g(Q_n)) \mid g \in \mathscr{L}(G)\} =\ev_D(\mathscr{L}(G)),\]


\begin{Theorem}\cite[Theorem~2.2.2]{stichtenoth2009algebraic}
	$C_{\mathcal{L}}(D, G)$ is an $[n, k, d]$ code with parameters
	\[
		k=\dim\mathscr{L}(G)-\dim\mathscr{L}(G-D) \quad \text { and } \quad d \geq n-\deg G .
	\]
\end{Theorem}

The dual of an AG code can be described as a residue code (see \cite{stichtenoth2009algebraic} for more details), \emph{i.e.}
\[ C_{\mathcal{L}}(D,G)^{\perp} = C_{\Omega}(D,G).\]


Furthermore, the differential code $C_{\Omega}(D, G)$ is monomially equivalent to the functional code 
\[C_{\mathcal{L}}(D, W+D-G), \]
where $W$ represents a canonical divisor of $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$. The notion of monomial equivalence of codes is defined as follows. Let $C \leq \mathbb{F}_q^n$ be linear subspaces and $\boldsymbol{\mu}=(\mu_1,\ldots,\mu_n) \in (\mathbb{F}_q^*)^n$ with non-zero entries. We define the Schur product
\[\boldsymbol{\mu} \star C = \{(\mu_1x_1, \ldots,\mu_nx_n) \mid (x_1,\ldots,x_n) \in C\}.\]
The vector $\boldsymbol{\mu}$ is also called a multiplier. Clearly, $\boldsymbol{\mu} \star C\leq \mathbb{F}_q^n$. Two linear codes $C_1,C_2 \leq \mathbb{F}_q^n$ are monomially equivalent if $C_2=\boldsymbol{\mu} \star C_1$ for some multiplier $\boldsymbol{\mu}$. Monomially equivalent codes share identical dimensions and minimum distances; however, this correspondence does not preserve all crucial properties of the code.


\subsection{Subfield subcodes and trace codes}
For the efficient construction of codes over $\mathbb{F}_q$, one approach involves working with codes originally defined over an extension field $\mathbb{F}_{q^m}$. When considering a code $\mathcal{C}$ within $\mathbb{F}_{q^m}^n$, a subfield subcode of $\mathcal{C}$ is its restriction to the field $\mathbb{F}_q$. This process, often employed in the definition of codes such as BCH codes, Goppa codes, and alternant codes, plays a fundamental role.

Let $q$ be a prime power and $m$ be a positive integer. Let $C$ denote a linear code of parameters $[n,k]$ defined over the finite field $\mathbb{F}_{q^m}$. The \emph{subfield subcode} of $C$ over $\mathbb{F}_q$, represented as $C|_{\mathbb{F}_q}$, is the set
\[
	C|_{\mathbb{F}_q} = C \cap \mathbb{F}_q^n,
\]
which consists of all codewords in $C$ that have their components in $\mathbb{F}_q$. 


The subfield subcode $C|_{\mathbb{F}_q}$ is a linear code over $\mathbb{F}_q$ with parameters $[n,k_0,d_0]$, satisfying the inequalities $d \leq d_0 \leq n$ and $n-k \leq n-k_0 \leq m(n-k)$. Moreover, a parity check matrix for $C$ over $\mathbb{F}_q$ provides up to $m(n-k)$ linearly independent parity check equations over $\mathbb{F}_q$ for the subfield subcode $C|_{\mathbb{F}_q}$. Typically, the minimum distance $d_0$ of the subfield subcode exceeds that of the original code $C$.

Let $\trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}$ denote the trace function from $\mathbb{F}_{q^m}$ down to $\mathbb{F}_q$, expressed as
\[
	\trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(x) = x + x^q + x^{q^2} + \ldots + x^{q^{m-1}}.
\]
For any vector $c = (c_1, c_2, \ldots, c_n) \in \mathbb{F}_q^n$, we define
\[
	\trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(c) = \left( \trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(c_1), \trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(c_2), \ldots, \trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(c_n) \right).
\]
Furthermore, for a linear code $C$ of length $n$ and dimension $k$ over $\mathbb{F}_{q^m}$, the code 
\[\trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(C) = \{\trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(c) \mid  c\in C\}\]
is a linear code of length $n$ and dimension $k_1$ over $\mathbb{F}_q$.

A seminal result by Delsarte connects subfield subcodes with trace codes:

\begin{Theorem}[\cite{Del75}]\label{delsarte}
	Let $C$ be a $[n,k]$ linear code over $\mathbb{F}_q$. Then the dual of the subfield subcode of $C$ is the trace code of the dual code of $C$, i.e., 
	\[
		(C|_{\mathbb{F}_q})^{\perp} = \trace_{\mathbb{F}_{q^m} / \mathbb{F}_q}(C^{\perp}).
	\]
\end{Theorem}
Finding the exact dimension of a subfield subcode of a linear code is typically a hard problem. However, a basic estimation can be obtained by applying Delsarte's theorem {\cite{Del75}}:
\begin{equation}
	\dim C|_{\mathbb{F}_q} \geq n - m(n-k).
\end{equation}


In \cite[Chapter~9]{stichtenoth2009algebraic}, various results are discussed with respect to subfield subcodes and trace codes of AG codes. This motivated us to formulate the following propositions on the dimension of the subfield subcodes of AG codes, which are useful for the case $G=sP$ with a place $P$ of higher degree.


\begin{Proposition} \label{prop:sub}
	Let $G_1$ be a positive divisor of the Hermitian curve $\mathscr{H}_q$, and $D=Q_1+\cdots+Q_n$ the sum of $\mathbb{F}_{q^2}$-rational places such that $\Supp(G)\cap \Supp(D)=\emptyset$. Assume that $\deg G_1 < n/q$. Then 
	\[
	\dim C_{\mathcal{L}}(D,G_1) \mid_{\mathbb{F}_q} = 1.
	\]
\end{Proposition}
\begin{proof}
	Let $f$ be a function in $\mathscr{L}(G_1)$ such that $f(Q_i) \in \mathbb{F}_q$ for $i=1,\cdots,n$. Then $f^q -f \in \mathscr{L}(qG_1)$ (since $\mathscr{L}(G_1)^q \subseteq \mathscr{L}(qG_1)$), hence $f^q - f \in  \mathscr{L}(qG_1-D)$ where
	\[\mathscr{L}(qG_1-D) = \ker \left(\operatorname{ev}_{D}\right)=\left\{x \in \mathscr{L}(qG_1) \mid v_{P_i}(x)>0 \text { for } i=1, \ldots, n\right\} .\]
	Since $\deg(qG_1-D)<0$, it follows that $\mathscr{L}(qG_1 - D)=0$ and $f^q -f =0$ which implies that $f \in \mathbb{F}_q$. Consequently $\dim C_{\mathcal{L}}(D,G_1)|_{ \mathbb{F}_q}= 1$.
\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{The geometry of Hermitian degree 3 places} \label{sec:geometry}

In this section, we collect useful facts on the degree 3 places of the Hermitian curve, their stabilizer subgroups, and Riemann-Roch spaces. 

\subsection{The Hermitian sesquilinear form} \label{ssec:h-form}
The Hermitian curve $\mathscr{H}_q$ has the affine equation $X^{q+1}=Y+Y^q$. The Hermitian function field $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$ is generated by $x,y$ so that $x^{q+1}=y+y^q$ holds. The Frobenius field automorphism $\Frob:x\mapsto x^{q^2}$ of the algebraic closure $\overline{\mathbb{F}}_{q^2}$ includes an action on rational functions, places, divisors, and curve automorphisms. For this action, we continue to use the notation $\Frob$ in the exponent: $P^\Frob$, $f^\Frob$, $D^\Frob$, etc. 

Let $K$ be a field extension of $\mathbb{F}_{q^2}$. An affine point is a pair $(a,b)\in K^2$. A projective point $(a:b:c)$ is a $1$-dimensional subspace $\{(at,bt,ct) \mid t\in K\}$ of $K^3$. If $c\neq 0$, then the projective point $(a:b:c)$ is identified with the affine point $(a/c,b/c)$. For $u=(u_1,u_2,u_3), v=(v_1,v_2,v_3) \in K^3$, we define the Hermitian form 
\begin{align*} %\label{eq:}
\langle u,v \rangle = u_1v_1^q-u_2v_3^q-u_3v_2^q.
\end{align*}
Clearly, $\langle u,v \rangle$ is additive in $u$ and $v$, $\langle \alpha u, \beta v\rangle =\alpha \beta^q \langle u,v \rangle$, and 
\begin{align*} %\label{eq:}
\langle u,v \rangle^q=\langle v^\Frob,u \rangle.
\end{align*}
The point $u$ is self-conjugate, if 
\begin{align*} %\label{eq:}
0=\langle u,u \rangle = u_1^{q+1}-u_2u_3^q-u_2^qu_3.
\end{align*}
This is the projective equation $X^{q+1}-YZ^q-Y^qZ=0$ of the Hermitian curve $\mathscr{H}_q$. 

Let $u=(u_1:u_2:u_3)$ be a projective point. The polar line of $u$ has equation
\[u^\perp: \langle (X_1,X_2,X_3), u \rangle = u_1^qX_1-u_3^qX_2-u_2^qX_3=0.\]
If $u$ is on $\mathscr{H}_q$, then $u^\perp$ is the tangent line at $u$. More precisely, $u^\perp$ intersects $\mathscr{H}_q$ at $u$ and $u^\Frob$ with multiplicities $q$ and $1$, respectively. If $u$ is $\mathbb{F}_{q^2}$-rational, then $u=u^\Frob$, and the intersection multiplicity is $q+1$. 

\subsection{Unitary transformations and curve automorphism} \label{ssec:unitary}

Let $A$ be a $3\times 3$ matrix. The linear map $u\mapsto uA$ will also be denoted by $A$. If $A$ is invertible, then it induces a projective linear transformation, denoted by $\hat{A}:(u_1:u_2:u_3)\mapsto (u_1':u_2':u_3')=(u_1:u_2:u_3)^{\hat{A}}$, where
\begin{align*} %\label{eq:}
u_1' &= a_{11}u_1+a_{21}u_2+a_{31}u_3, \\
u_2' &= a_{12}u_1+a_{22}u_2+a_{32}u_3, \\
u_3' &= a_{13}u_1+a_{23}u_2+a_{33}u_3. 
\end{align*}
We use the same notation $\hat{A}:(X,Y) \mapsto (X',Y')=(X,Y)^{\hat{A}}$ for the partial affine map
\begin{align*} %\label{eq:}
(X,Y) \mapsto (X',Y') = \left(\frac{a_{11}X+a_{21}Y+a_{31}}{a_{13}X+a_{23}Y+a_{33}}, \frac{a_{12}X+a_{22}Y+a_{32}}{a_{13}X+a_{23}Y+a_{33}}\right).
\end{align*}
The action $f(X,Y) \mapsto f((X,Y)^{\hat{A}^{-1}})$ of $\hat{A}$ on rational functions will be indicated by $A^*$. The following lemma is straightforward.
\begin{Lemma} \label{lm:f-action}
Let $f(X,Y)$ be a polynomial of total degree $n$. Define the degree $n$ homogeneous polynomial $F(X,Y,Z)=Z^n f(X/Z,Y/Z)$. Then
\[f^{A^*}(X,Y)=\frac{F((X,Y,1)A^{-1})}{(a_{13}X+a_{23}Y+a_{33})^n}.\]
\end{Lemma}
We remark that the line $a_{13}X+a_{23}Y+a_{33}=0$ can be seen as the pre-image of the line at infinity under $\hat{A}$. 

The linear transformation $A$ is unitary if 
\[\langle uA, vA \rangle = \langle u,v \rangle\]
holds for all $u,v$. Since $\langle .,. \rangle$ is non-degenerate, unitary transformations are invertible. Moreover, for all $u,v$ one has
\begin{align*}
\langle (v^\Frob)A, uA \rangle &= \langle v^\Frob,u \rangle \\
&= \langle u,v \rangle^q \\
&= \langle uA,vA \rangle^q \\
&= \langle (vA)^\Frob,uA \rangle. \\
\end{align*}
This implies $(v^\Frob)A = (vA)^\Frob$ for all $v$, that is, $A$ and $\Frob$ commute. This shows that unitary transformations are defined over $\mathbb{F}_{q^2}$. They form a group which is denoted by $GU(3,q)$. A useful fact is that if $b_1,b_2,b_3$ is a basis and
\[\langle b_iA, b_jA \rangle = \langle b_i,b_j \rangle\]
for all $i,j\in \{1,2,3\}$, then $A$ is unitary. 

Let $A\in GU(3,q)$. If $(x,y)$ is a generic point of $\mathscr{H}_q$, then $(x',y')=(x,y)^{\hat{A}}$ satisfies 
\[(x')^{q+1}-y'-(y')^q=\langle x',y' \rangle = \langle x,y \rangle=0. \] 
Therefore, $(x',y')$ is a generic point of $\mathscr{H}_q$, and $A^*$ induces an automorphism of the function field $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$. If $A$ is defined over $\mathbb{F}_{q^2}$, then $A^*$ is an automorphism of $\mathbb{F}_{q^2}(\mathscr{H}_q)$. 



\subsection{Places of degree 3 and their lines} \label{ssec:places-lines}
Let $a_1,b_1 \in \mathbb{F}_{q^6}\setminus \mathbb{F}_{q^2}$ be scalars such that $a_1^{q+1}=b_1+b_1^q$. In other words, $(a_1,b_1)$ is an affine point of $\mathscr{H}_q:X^{q+1}=Y+Y^q$, defined over $\mathbb{F}_{q^6}$. Write $a_2=a_1^{q^2}$, $b_2=b_1^{q^2}$, $a_3=a_2^{q^2}$, $b_3=b_2^{q^2}$, and $p_i=(a_i,b_i,1)$. Then $p_{i+1}=p_i^\Frob$, $\langle p_i,p_i \rangle = 0$, and 
\begin{align*} %\label{eq:}
0=\langle p_i,p_i \rangle ^q = \langle p_i^\Frob,p_i \rangle = \langle p_{i+1},p_i \rangle
\end{align*}
hold for $i=1,2,3$, the indices taken modulo $3$. Since $\langle .,. \rangle$ is non-trivial, $\gamma_i = \langle p_i,p_{i+1} \rangle \in \mathbb{F}_{q^6}\setminus \{0\}$. More precisely,
\begin{align*} %\label{eq:}
\gamma_1^{q^3}=\langle p_1,p_{2} \rangle^{q^3} = \langle p_2^\Frob,p_{1} \rangle^{q^2} = \langle p_2^{(\Frob)^2},p_{1}^\Frob \rangle = \langle p_1,p_2 \rangle = \gamma_1,
\end{align*}
which shows $\gamma_i \in \mathbb{F}_{q^3}\setminus \{0\}$. Clearly, $\gamma_{i+1} = \gamma_i^{q^2}$ and $\gamma_{i+2} = \gamma_i^{q}$. By $\gamma_i\neq 0$, the vectors $p_1,p_2,p_3$ are linearly independent over $\mathbb{F}_{q^6}$. 

Let $K$ be a field containing $\mathbb{F}_{q^6}$. Since $p_1,p_2,p_3$ is a basis in $K^3$, any $u\in K^3$ can be written as
\begin{align*} %\label{eq:}
u=x_1p_1+x_2p_2+x_3p_3,
\end{align*}
with $x_i\in K$. Computing
\begin{align*}
\langle u, p_{i+1} \rangle = \langle x_1p_1+x_2p_2+x_3p_3, p_{i+1} \rangle = x_i \langle p_{i}, p_{i+1} \rangle,
\end{align*}
we obtain $x_i=\langle u,p_{i+1} \rangle / \gamma_i$. In the basis $p_1,p_2,p_3$, the Hermitian form has the shape
\begin{align*}
\langle u,v \rangle &= \langle x_1p_1+x_2p_2+x_3p_3,y_1p_1+y_2p_2+y_3p_3 \rangle \\
&= x_1y_2^q \langle p_1,p_2 \rangle + x_2y_3^q \langle p_2,p_3 \rangle + x_3y_1^q \langle p_3,p_1 \rangle\\
&=\gamma_1 x_1y_2^q+\gamma_1^{q^2} x_2y_3^q+\gamma_1^{q^4} x_3y_1^q.
\end{align*}
In this coordinate frame, the Hermitian curve has projective equation
\begin{align*} %\label{eq:}
\gamma_1 X_1X_2^q+\gamma_1^{q^2} X_2X_3^q+\gamma_1^{q^4} X_3X_1^q=0.
\end{align*}

Let $x,y$ be the generators of the function field $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$ such that $x^{q+1}=y+y^q$. Write
\begin{align*} %\label{eq:}
\ell_i=\langle (x,y,1), p_i \rangle = a_i^qx-y-b_i^q.
\end{align*}
Then
\begin{align*} %\label{eq:}
(x,y,1)=\frac{\ell_{2}}{\gamma_1} p_1+\frac{\ell_{3}}{\gamma_2} p_2+\frac{\ell_{1}}{\gamma_3} p_3
\end{align*}
and
\begin{align} \label{eq:ell-q-lin-dep}
0=x^{q+1}-y-y^q = \langle (x,y,1), (x,y,1) \rangle = \frac{\ell_1\ell_{2}^q}{\gamma_1^q} + \frac{\ell_2\ell_{3}^q}{\gamma_2^q} + \frac{\ell_3\ell_{1}^q}{\gamma_3^q}.
\end{align}
The Hermitian curve $\mathscr{H}_q$ is non-singular, the places of $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$ correspond to the projective points over the algebraic closure $\overline{\mathbb{F}}_{q^2}$. Let $P_i$ denote the place corresponding to $(a_i:b_i:1)$. $P_i$ is defined over $\mathbb{F}_{q^6}$, $P_{i+1}=P_i^\Frob$, and 
\begin{align*} %\label{eq:}
P=P_1+P_2+P_3
\end{align*}
is an $\mathbb{F}_{q^2}$-rational place of degree $3$. 

The line $a_i^qX-Y-b_i^q=0$ is tangent to $\mathscr{H}_q$ at $p_i$, the intersection multiplicities are $q$ and $1$ at $p_i$ and $p_{i+1}$, respectively. This implies that the zero divisor $(\ell_i)_0$ is $qP_i+P_{i+1}$, and the principal divisor of $\ell_i$ is
\begin{align} \label{eq:div-ell-i}
(\ell_i)=qP_i+P_{i+1}-(q+1)Q_\infty.
\end{align}



\subsection{The stabilizer of a degree 3 place} \label{ssec:stabilizer}
Let $\beta_1\in \mathbb{F}_{q^6}$ be an element such that $\beta_1^{q^3+1}=1$. Define $\beta_2=\beta_1^{q^2}$, $\beta_3=\beta_2^{q^2}$. Then 
\begin{align*} %\label{eq:}
\beta_i\beta_{i+1}^q=\beta_i^{q^3+1}=1.
\end{align*}
For $p'_i=\beta_i p_i$, this implies that
\begin{align*} %\label{eq:}
\langle p_i',p_{i+1}' \rangle = \beta_i\beta_{i+1}^q \langle p_i,p_{i+1} \rangle = \langle p_i,p_{i+1} \rangle.
\end{align*}
Hence, for all $i,j\in \{1,2,3\}$, 
\begin{align*} %\label{eq:}
\langle p_i',p_{j}' \rangle = \langle p_i,p_{j} \rangle.
\end{align*}
This shows that we can extend the map $p_i\mapsto p_i'$ to a unitary linear map $B=B(\beta_1):u\mapsto u'$ in the following way. Write
\begin{align*} %\label{eq:}
u=x_1p_1+x_2p_2+x_3p_3,
\end{align*}
with $x_i=\langle u,p_{i+1} \rangle / \gamma_i$, and define
\begin{align} \label{eq:Bdef}
u'=x_1p_1'+x_2p_2'+x_3p_3' = x_1\beta_1 p_1+x_2\beta_2p_2+x_3\beta_3p_3.
\end{align}
The extension $B$ is a unique unitary transformation. As we have seen in Section \ref{ssec:unitary}, this implies that $B=B(\beta_1)$ is a well-defined element of the general unitary group $GU(3,q)$. The set 
\[\mathcal{B}=\{B(\beta_1) \mid \beta_1 \in \mathbb{F}_{q^6}, \; \beta_1^{q^3+1}=1\}\]
is a cyclic subgroup of $GU(3,q)$, whose order is $|\mathcal{B}|=q^3+1$. 

In the projective plane, $B$ induces a projective linear transformation $\hat{B}$. $\hat{B}$ is trivial if and only if $\beta_1=\beta_2=\beta_1^{q^2}$, that is, if and only if $\beta_i\in \mathbb{F}_{q^2}$. As $\gcd(q^3+1,q^2-1)=q+1$, $\hat{B}$ is trivial if and only if $\beta_1^{q+1}=1$. The set $\hat{\mathcal{B}} = \{\hat{B} \mid B\in \mathcal{B}\}$ is a cyclic group of unitary projective linear transformations, whose order is $|\hat{\mathcal{B}}|=q^2-q+1$. 

In a similar way, we fix the elements 
\[\delta_i=\gamma_i^\frac{q^3-q}{2}.\] %\in \mathbb{F}_{q^6}
Since $\gamma_1 \in \mathbb{F}_{q^3}$, $\delta_{i}\in \mathbb{F}_{q^3}$. Moreover,
\[\delta_i^{q^3+1}=\delta_i^2=\gamma_i^{q^3-q}=\gamma_i^{1-q}.\] 
As before, the map 
\[\Delta:p_i\mapsto p_i''=\delta_i p_{i-1}\]
preserves the Hermitian form:
\[\langle p_i'',p_{i+1}'' \rangle = \langle \delta_{i} p_{i-1}, \delta_{i+1} p_{i} \rangle = \delta_{i}^{q^3+1} \langle p_{i-1},p_{i} \rangle = \gamma_i^{1-q} \gamma_{i-1} =\gamma_i.\]
Hence, $\Delta$ extends to a unitary linear map, which commutes with $\Frob$ and normalizes $\mathcal{B}$. Indeed,
\[ p_{i}^{\Delta^{-1}B\Delta} = (\delta_{i+1}^{-1}p_{i+1})^{B\Delta} = (\delta_{i+1}^{-1}\beta_{i+1} p_{i+1})^\Delta = \beta_{i+1} p_i, \]
hence, $\Delta^{-1}B\Delta=B^{q^2}$. $\Delta^3$ maps $p_i$ to $\delta_1\delta_2\delta_3 p_i$, and
\[\delta_1\delta_2\delta_3=\delta_1^{1+q+q^2}=\left(\gamma_1^\frac{q^3-q}{2}\right)^{1+q+q^2}= \left(\gamma_1^{q^3-1}\right)^\frac{(q+1)q}{2}=1.\]
Therefore, $\Delta$ has order $3$. 

As introduced in Section \ref{ssec:unitary}, the unitary transformations $B$ and $\Delta$ induce automorphisms $B^*$ and $\Delta^*$ of the function field. 
\begin{Proposition}
The group $\mathcal{B}^* = \{B^* \mid B \in \mathcal{B}\}$ of curve automorphisms has order $q^2-q+1$, and $\Delta^*$ normalizes $\mathcal{B}^*$ by 
\[(\Delta^*)^{-1}B^*\Delta^*=(B^*)^{q^2}=(B^*)^{q-1}.\]
Both $\mathcal{B}^*$ and $\Delta^*$ stabilize the degree $3$ place $P$. \qed
\end{Proposition}

\begin{Proposition} \label{pr:B-star-elli} 
Let $\beta_1 \in \mathbb{F}_{q^6}$ be an element such that $\beta_1^{q^3+1}=1$. Define $\beta_2=\beta_1^{q^2}$, $\beta_3=\beta_2^{q^2}$, and the unitary map $B=B(\beta_1) \in \mathcal{B}$. Then 
\[\left(\frac{\ell_i}{\ell_{i+1}}\right)^{B^*} = \beta_i^{q+1}\left(\frac{\ell_i}{\ell_{i+1}}\right).\]
\end{Proposition}
\begin{proof}
By Lemma \ref{lm:f-action},
\begin{align*}
\ell_i^{B^*} & = \frac{\langle (x,y,1)B^{-1}, p_i \rangle }{w} \\
&= \frac{\langle (x,y,1), p_i B \rangle }{w} \\
&= \frac{\langle (x,y,1), \beta_i p_i \rangle }{w} \\
&= \frac{\beta_i^q \ell_i}{w},
\end{align*}
where the linear $w=w_1x+w_2y+w_3$ over $\mathbb{F}_{q^2}$ depends only on $B$. Therefore,
\[\left(\frac{\ell_i}{\ell_{i+1}}\right)^{B^*} = \frac{\beta_i^q}{\beta_{i+1}^q}\left(\frac{\ell_i}{\ell_{i+1}}\right) = \beta_i^{q-q^3}\left(\frac{\ell_i}{\ell_{i+1}}\right) = \beta_i^{q+1}\left(\frac{\ell_i}{\ell_{i+1}}\right). \qedhere\]
\end{proof}


\section{Riemann-Roch spaces associated with a degree $3$ place} \label{sec:riemann-roch}
In this section, we keep using the notation of the previous section: $P_i$ is a degree 1 place of $\mathbb{F}_{q^6}(\mathscr{H}_q)$, associated to the projective point $(a_i:b_i:1)$. $P_i^\Frob=P_{i+1}$; the index $i=1,2,3$ is always taken modulo $3$. $P=P_1+P_2+P_3$ is an $\mathbb{F}_{q^2}$-rational place of degree $3$ of $\mathbb{F}_{q^2}(\mathscr{H}_q)$. The generators $x,y$ of $\overline{\mathbb{F}}_{q^2}(\mathscr{H}_q)$ satisfy $x^{q+1}=y+y^q$. The rational function $\ell_i=a_i^qx-y-b_i^q$ is obtained from the tangent line of $\mathscr{H}_q$ at $P_i$. 

\subsection{Basis and decomposition of the Riemann-Roch space}
Let $s,u,v$ be positive integers such that $v\leq q$ and $s=u(q+1)-v$. Clearly, $u,v$ are uniquely defined by $s$. In \cite{korchmaros2013hermitian}, the Riemann-Roch space associated with the divisor $sP$ is given as
\[\mathscr{L}(sP) = \left\{ \frac{f}{(\ell_1\ell_2\ell_3)^u} \mid f \in \mathbb{F}_{q^2}[X,Y], \; \deg f \leq 3u, \; v_{P_i}(f) \geq v \right\} \cup \{0\}.\]
The Weierstrass semigroup $H(P)$ consists of the integers $s\geq 0$ such that the pole divisor $(f)_\infty=sP$ for some $f\in {\mathbb{F}_{q^2}}(\mathscr{H}_q)$, see \cite{beelen2023weierstrass}. If $s\not\in H(P)$, then it is called a Weierstrass gap; the set of Weierstrass gaps is denoted by $G(P)$. By \cite[Theorem 3.1]{korchmaros2013hermitian}, we have
\[G(P) = \{u(q+1)-v \mid 0\leq v\leq q, \; 0<3u\leq v\}.\]
By the Weierstrass Gap Theorem \cite[Theorem 1.6.8]{stichtenoth2009algebraic}, $|G(P)|=\g$ for a place of degree $1$. In our case, $P$ has degree $3$ and the situation is slightly more complicated.

\begin{Lemma} \label{lm:GP-size}
\[3|G(P)| = \begin{cases}
\g & \text{if $q\equiv 0,1 \pmod3$,} \\
\g-1 & \text{if $q\equiv 2 \pmod3$.} \\
\end{cases}\]
\end{Lemma}
\begin{proof}
The lemma follows from
\begin{align*}
|G(P)| &= \sum_{1 \leq u \leq q/3} |\{3u,\ldots,q\}| \\
&= \sum_{i=1}^{\lfloor q/3 \rfloor} q+1-3u \\
&= \frac{\lfloor q/3 \rfloor(2q-1-3\lfloor q/3 \rfloor)}{2}. \qedhere
\end{align*}
\end{proof}

The following proposition gives an explicit basis for the Riemann-Roch space $\mathscr{L}(sP)$ over the extension field $\mathbb{F}_{q^6}$.
\begin{Proposition} \label{pr:Uti-props}
Let $t,u,v$ be positive integers such that $v\leq q$ and $t=u(q+1)-v$. Define the rational functions
\[U_{t,i} = \ell_i^{2u-v}\ell_{i+1}^{v-u}\ell_{i+2}^{-u} = \left(\frac{\ell_i}{\ell_{i+2}}\right)^u\left(\frac{\ell_{i+1}}{\ell_i}\right)^{v-u}, \qquad i=1,2,3.\]
Define $U_{0,i}=1$ as the constant function for $i=1,2,3$. Then the following holds:
\begin{enumerate}[label=(\roman*)]
\item $(U_{t,i})^\Frob = U_{t,i+1}$. 
\item The principal divisor of $U_{t,i}$ is 
\[(U_{t,i}) = -tP + \big((3u-v-1)q+(q-v)\big) P_i + \big(v(q-2)+3u\big) P_{i+1}.\]
In particular, if $3u\geq v+1$, then $(U_{t,i}) \geq -tP$. 
\item The elements $U_{t,i}$, $t\geq 0$, $i=1,2,3$ are linearly independent with the following exception: $q\equiv 2 \pmod{3}$, $t=(q^2-q+1)/3$, 
\begin{align} \label{eq:U-lin-dep}
\frac{U_{t,1}}{\gamma_{1}^q} + \frac{U_{t,2}}{\gamma_{2}^q} + \frac{U_{t,3}}{\gamma_{3}^q} =0.
\end{align}
\item The set
\[\mathcal{U}(s) = \{U_{t,i} \mid t\in H(P), \; t\leq s, \; i=1,2,3, \; (3t,i) \neq (q^2-q+1,3)\}\]
of rational functions is a basis of $\mathscr{L}(sP)$ over $\mathbb{F}_{q^6}$. 
\end{enumerate}
\end{Proposition}
\begin{proof}
Notice first that $u,v$ are uniquely defined by $t$, therefore $U_{t,i}$ is well defined. (i) is trivial, and (ii) is straightforward from \eqref{eq:div-ell-i}. To show (iii), let us write a linear combination in the form
\begin{align} \label{eq:U-lin-comb}
\alpha_1 U_{t,1}+\alpha_2 U_{t,2} + \alpha_3 U_{t,3} = \sum\limits_{\substack{r<t \\ i=1,2,3}} \lambda_{r,i} U_{r,i}
\end{align}
such that $(\alpha_1,\alpha_2,\alpha_3)\neq (0,0,0)$. The right-hand side has valuation at least $-t+1$ at $P_1,P_2,P_3$. If $t\neq (q^2-q+1)/3$ and $\alpha_i\neq 0$, then the right-hand side has valuation $-t$ at $P_{i+2}$. Hence, $\alpha_i=0$ for all $i=1,2,3$, a contradiction. Assume $t=(q^2-q+1)/3$. Then
\[U_{t,i}=\frac{\ell_i\ell_{i+1}^q}{(\ell_1\ell_2\ell_3)^\frac{q+1}{3}},\]
and \eqref{eq:U-lin-dep} follows from \eqref{eq:ell-q-lin-dep}. We can use \eqref{eq:U-lin-dep} to eliminate $U_{t,3}$ from \eqref{eq:U-lin-comb}, that is, we can assume $\alpha_3=0$. Then again, the only term that has a valuation $-t$ at $P_{i+2}$ is $\alpha_iU_{t,i}$ with $\alpha_i\neq 0$. Since the left- and right-hand sides of \eqref{eq:U-lin-comb} must have the same valuations at $P_1,P_3$, $\alpha_1=\alpha_2=0$ must hold, a contradiction. 

(iv) By (iii), $\mathcal{U}(s)$ consists of linearly independent elements. To show that it is a basis of $\mathscr{L}(sP)$, it suffices to show that $|\mathcal{U}(s)|=\dim(\mathscr{L}(sP))$ for $3s\geq 2\g-2$. On the one hand, in this case $\dim(\mathscr{L}(sP)) = 3s+1-\g$. On the other hand, 
\[|\mathcal{U}(s)|=1+3(s-|G(P)|)-\varepsilon = 3s+1-(3|G(P)|+\varepsilon),\]
where $\varepsilon=0$ if $q\equiv0,1\pmod3$, and $\varepsilon=1$ if $q\equiv 2\pmod3$. By Lemma \ref{lm:GP-size}, $3|G(P)|+\varepsilon = \g$, and the claim follows. 
\end{proof}

It is useful to have a decomposition of $\mathscr{L}(sP)$ over $\mathbb{F}_{q^2}$.

\begin{Theorem} \label{th:Wt-props}
For $t\geq 0$ integer and $\alpha \in \mathbb{F}_{q^6}$ define the $\mathbb{F}_{q^2}$-rational function 
\[W_{t,\alpha} = \alpha U_{t,1} + \alpha^{q^2} U_{t,2} + \alpha^{q^4} U_{t,3}\]
and the $\mathbb{F}_{q^2}$-linear space
\[\mathcal{W}_t = \{W_{t,\alpha} \mid \alpha \in \mathbb{F}_{q^6}\}.\]
For $t\in H(P)$, we have
\[\dim(\mathcal{W}_t) = \begin{cases}
1 & \text{if $t=0$,} \\
2 & \text{if $q\equiv 2\pmod3$ and $t=(q^2-q+1)/3$,} \\
3 & \text{otherwise.}
\end{cases}\]
The $\mathbb{F}_{q^2}$-rational Riemann-Roch space $\mathscr{L}(sP)$ has the direct sum decomposition
\begin{align} \label{eq:LsP-decomp}
\mathscr{L}(sP) = \bigoplus_{t\in H(P), \, t\leq s} \mathcal{W}_t.
\end{align}
\end{Theorem}
\begin{proof}
For $t\in H(P)$, $\mathcal{W}_t$ is the set of $\mathbb{F}_{q^2}$-rational functions in the space spanned by $U_{t,1}, U_{t,2}, U_{t,3}$. The claims follow from Proposition \ref{pr:Uti-props}. 
\end{proof}

\subsection{Invariant subspaces of $\mathscr{L}(sP)$}

\begin{Lemma} \label{lm:b-q+1}
Let $b\in \mathbb{F}_{q^6}$ such that $b^{q^3+1}=1$. Then $(b^{q+1})^{q^2}=(b^{q+1})^{q-1}$ and $(b^{q+1})^{q^4}=(b^{q+1})^{-q}$.
\end{Lemma}
\begin{proof}
By assumption, $b^{q+1}$ has order $q^2-q+1$. The claim follows from the facts that $q^2-(q-1)$ and $q^4-q$ are divisible by $q^2-q+1$. 
\end{proof}

The following lemma shows that the basis elements in $\mathcal{U}(s)$ are eigenvectors of $\mathcal{B}^*$. 

\begin{Lemma} \label{lm:B-start-on-U}
Let $\beta_1 \in \mathbb{F}_{q^6}$ be an element such that $\beta_1^{q^3+1}=1$. Define $\beta_2=\beta_1^{q^2}$, $\beta_3=\beta_2^{q^2}$, and the unitary map $B=B(\beta_1) \in \mathcal{B}$. Then
\[(U_{t,i})^{B^*} = \beta_i^{t(q+1)} U_{t,i}.\]
\end{Lemma}
\begin{proof}
Proposition \ref{pr:B-star-elli} implies
\[\left(\frac{\ell_i}{\ell_{i+2}}\right)^{B^*} = \frac{1}{\beta_{i+2}^{q+1}}\left(\frac{\ell_i}{\ell_{i+2}}\right)\]
and
\[\left(\frac{\ell_{i+1}}{\ell_{i}}\right)^{B^*} = \frac{1}{\beta_{i}^{q+1}}
\left(\frac{\ell_{i+1}}{\ell_{i}}\right).\]
By Lemma \ref{lm:b-q+1}, $\frac{1}{\beta_{i+2}^{q+1}} = (\beta_{i}^{q+1})^{-q^4} = (\beta_{i}^{q+1})^{q}$. Write $t=u(q+1)-v$ with $0\leq v\leq q$. Then, 
\[B^*: \left(\frac{\ell_i}{\ell_{i+2}}\right)^u\left(\frac{\ell_{i+1}}{\ell_i}\right)^{v-u} \mapsto (\beta_i^{q+1})^{qu}  \left(\frac{\ell_i}{\ell_{i+2}}\right)^u (\beta_{i}^{q+1})^{-v+u} \left(\frac{\ell_{i+1}}{\ell_i}\right)^{v-u}\]
The result follows from the definition of $u$ and $v$. 
\end{proof}

\begin{Proposition}
\begin{enumerate}[label=(\roman*)]
\item Let $\beta_1 \in \mathbb{F}_{q^6}$ be an element such that $\beta_1^{q^3+1}=1$, and $B=B(\beta_1) \in \mathcal{B}$. Then
\[(W_{t,\alpha})^{B^*} = W_{t,\beta_1^{t(q+1)}\alpha}.\]
\item The subspaces $\mathcal{W}_t$, $t\in H(P)$ are $\mathcal{B}^*$-invariant. 
\item The $\mathbb{F}_{q^2}\mathcal{B}^*$-modules $\mathcal{W}_t$ and $\mathcal{W}_s$ are isomorphic if and only if one of the following holds:
\begin{enumerate}[label=\alph*)]
\item $s\equiv t \pmod{q^2-q+1}$, 
\item $s\equiv (q-1)t \pmod{q^2-q+1}$, or 
\item $s\equiv -qt \pmod{q^2-q+1}$. 
\end{enumerate}
\end{enumerate}
\end{Proposition}
\begin{proof}
(i) and (ii) follow from Lemma \ref{lm:B-start-on-U}. (iii) Let $\Phi:\mathcal{W}_t \to \mathcal{W}_s$ be an $\mathbb{F}_{q^2}\mathcal{B}^*$-module isomorphism between $\mathcal{W}_t$ and $\mathcal{W}_s$. It can be written as
\[(W_{t,\alpha})^\Phi = W_{t,\alpha \varphi},\]
where $\varphi:\mathbb{F}_{q^6}\to \mathbb{F}_{q^6}$ is an $\mathbb{F}_{q^2}$-linear bijection. Moreover,
\begin{align*}
(W_{t,\alpha})^{B^*\Phi} & = (W_{t,\beta_1^{t(q+1)} \alpha})^\Phi = W_{s,(\beta_1^{t(q+1)}\alpha)\varphi}, \\
(W_{t,\alpha})^{\Phi B^*} & = (W_{s,\alpha\varphi})^{B^*} = W_{s,\beta_1^{s(q+1)}(\alpha\varphi)}.
\end{align*}
Since $b=\beta_1^{q+1}$ satisfies $b^{q^2-q+1}=1$, this means that for any $\alpha, b\in \mathbb{F}_{q^6}$, $b^{q^2-q+1}=1$, we have
\[(b^t \alpha) \varphi = b^s(\alpha\varphi).\]
Let $b$ be an element of order $q^2-q+1$ in $\mathbb{F}_{q^6}$. If $b^t$ or $b^s$ is in $\mathbb{F}_{q^2}$, then $b^t=b^s$ and a) hold. Assume that neither $b^t$ nor $b^s$ is in $\mathbb{F}_{q^2}$. Then $\mathbb{F}_{q^6}=\mathbb{F}_{q^2}(b^t)=\mathbb{F}_{q^2}(b^s)$, and over $\mathbb{F}_{q^2}$, the minimal polynomial of $b^t$ has the degree $3$. Assume $b^{3t}+c_1b^{2t}+c_2b^t+c_3=0$ with $c_0,c_1,c_2\in \mathbb{F}_{q^2}$. Then
\begin{align*}
0&=(b^{3t}+c_1b^{2t}+c_2b^t+c_3)\varphi \\
&= (b^{3t}\varphi)+c_1(b^{2t}\varphi)+c_2(b^t\varphi)+c_3(1\varphi) \\
&= (b^{3s}+c_1b^{2s}+c_2b^s+c_3)(1\varphi). \\
\end{align*}
As $\varphi$ is bijective, $1\varphi\neq 0$, $0=b^{3s}+c_1b^{2s}+c_2b^s+c_3$ follows. This means that $b^s$ has the same minimal polynomial and $b^t \to b^s$ extends to a field automorphism of $\mathbb{F}_{q^6}$ over $\mathbb{F}_{q^2}$. This implies $b^s=b^t$, $b^s=(b^t)^{q^2}$ or $b^s=(b^t)^{q^4}$, and the claim follows. 
\end{proof}

\section{Hermitian codes of degree $3$ places and their duals \label{sec:Herm}}

In this section, we explore the one-point Hermitian codes of degree $3$ places and their dual codes. Let $P$ be a degree $3$ place on the Hermitian curve $\mathscr{H}_q$, $Q_1,\ldots,Q_n,Q_\infty$ its $\mathbb{F}_{q^2}$-rational places, where $n=q^3$. We define the divisors $D=Q_1+Q_2+\cdots+Q_n$, $\widetilde{D}=D+Q_{\infty}$, and $G=sP$ for a positive integer $s$.


\subsection{Functional Hermitian codes of degree $3$ places}
Given a divisor $D$ and $G$, we define the degree $3$ place functional Hermitian code $C_{\mathcal{L}}(D,sP)$ as:

\[C_{\mathcal{L}}(D,G):= \left\lbrace \left(g(Q_1),g(Q_2),\cdots,g(Q_n) \right)\,\, |\,\, g \in  \mathscr{L}(G) \right\rbrace, \]

This code forms an $[n,k]$ AG code, where $k\geq 3s-\g+1$, achieving equality when $\lfloor\frac{ 2 \g-2}{3}\rfloor <s<n/3$. Furthermore, the code has a minimum distance $d\geq d^*=q^3-3s$, where $d^*$ the designed minimum distance.

Furthermore, another degree $3$ place functional Hermitian code associated with $G$, denoted by $C_{\mathcal{L}}(\widetilde{D},G)$, is constructed by evaluating the functions in $\mathscr{L}(G)$ at all rational points $Q_1,Q_2,\cdots,Q_n$, and the point at infinity $Q_{\infty}$, as follows:

\[C_{\mathcal{L}}(\widetilde{D},G):= \left\lbrace \left(g(Q_1),g(Q_2),\cdots,g(Q_n),g(Q_{\infty}) \right)\,\, |\,\, g \in  \mathscr{L}(G)\right\rbrace ,\]

Clearly, $C_{\mathcal{L}}(\widetilde{D},G)$ has length of $n+1$. Concerning the dimension, we have the following result.
\begin{Proposition}
If $s< q^3/3$, then $\mathscr{L}(sP)$, $C_{\mathcal{L}}(D,G)$ and $C_{\mathcal{L}}(\widetilde{D},G)$ have the same dimension. 
\end{Proposition}
\begin{proof}
If $f\in \ker \ev_D$, then $f\in \mathscr{L}(sP-D)$, which is trivial if $s<q^3/3$. In this case, $\ker \ev_{\widetilde{D}}$ is also trivial. 
\end{proof}

\begin{Remark}
Numerical experiments show that $\mathscr{L}(sP)$, $C_{\mathcal{L}}(D,G)$ and $C_{\mathcal{L}}(\widetilde{D},G)$ have the same dimension if $s<(q^3+1)/3+q-1$. 
\end{Remark}


In the study of the divisors $D$ and $\widetilde{D}$, we make use of the polynomial 
\[R(X,Y) = X \prod\limits_{\substack{c \in \mathbb{F}_{q^2} \\ c^q + c \neq 0}} (Y-c).\] 
As shown in \cite[Section~2]{korchmaros2013hermitian}, the principal divisor of $R(x,y) \in \mathbb{F}_{q^2}(\mathscr{H}_q)$ is
\begin{align} \label{eq:Rxy-pricdiv}
(R(x,y)) = D-q^3 Q_\infty.
\end{align}
Further properties of $R(x,y)$ are given in the following proposition.
\begin{Proposition} \label{pr:Rxy-props}
In the function field, we have 
\[x^{q}R(x, y) = y^{q^2} - y \qquad \text{and} \qquad R(x, y) = x^{q^2} - x.\]
The differential of $R(x,y)$ is 
\[d(R(x,y))=-dx. \]
\end{Proposition} 
\begin{proof}
Clearly,
\[\prod\limits_{\substack{c \in \mathbb{F}_{q^2} \\ c^q + c = 0}} (Y-c) = Y^q+Y,\]
and
\[\prod\limits_{\substack{c \in \mathbb{F}_{q^2} \\ c^q + c \neq 0}} (Y-c) = \frac{\prod\limits_{c \in \mathbb{F}_{q^2}} (Y-c)}{\prod\limits_{\substack{c \in \mathbb{F}_{q^2} \\ c^q + c = 0}} (Y-c)} = \frac{Y^{q^2}-Y}{Y^q+Y}.\]
Hence, by $x^{q+1}=y+y^q$, 
\[x^qR(x,y) = x^{q+1} \prod\limits_{\substack{c \in \mathbb{F}_{q^2} \\ c^q + c \neq 0}} (y-c) = x^{q+1}\frac{y^{q^2}-y}{y^q+y} = y^{q^2}-y.\]
Using this we obtain
\begin{align*}
x^q(x^{q^2}-x) = (x^{q+1})^q-x^{q+1} = y^q+y^{q^2} - (y+y^q) = y^{q^2}-y = x^qR(x,y).
\end{align*}
Canceling by $x^q$, we get $R(x,y)=x^{q^2}-x$, and $d(R(x,y))=-dx$ follows immediately. 
\end{proof}

\subsection{Differential Hermitian codes of degree $3$ places}

Differential Hermitian codes of degree $3$ places are essential counterparts to functional codes on the Hermitian curve $\mathscr{H}_q$. The dual code $C_{\Omega}(D,G)$ of $C_{\mathcal{L}}(D,G)$ is called the differential code. It constitutes a $[n, \ell(G -D)-\ell(G) +\deg D, d^{\perp}]$ code, where $d^{\perp} \leq \deg(G) - (2\g -2)$, with $\deg(G) - (2\g -2)$ being its designed distance.

\cite[Proposition 8.1.2]{stichtenoth2009algebraic} provides an explicit description of the differential code as functional code
\[C_\Omega(D,G) = C_\mathscr{L}(D-G+(dt)-(t)),\]
where $t$ is an element of $\mathbb{F}_{q^2}(\mathscr{H}_q)$ such that $v_{Q_i}(t)=1$ for all $i\in \{1,\ldots,q^3,\infty\}$. If $G=sP$ and $D=Q_1+\cdots+Q_{q^3}$, then $t=R(x,y)$ is a good choice with 
\[(dt)=(-dx)=(2\g-2)Q_{\infty}=(q-2)(q+1)Q_{\infty}, \]
see \cite[Lemma 6.4.4]{stichtenoth2009algebraic}. Then, \eqref{eq:Rxy-pricdiv} implies the following proposition:
\begin{Proposition}
\[C_\Omega(D,sP) = C_\mathscr{L}(D,(q^3+q^2-q-2)Q_{\infty}-sP). \qed\]
\end{Proposition}

The computation of $C_\Omega(\widetilde{D},sP)$ is more complicated. We claim the next results for the prime powers $q\equiv 2 \pmod3$, since the proofs are rather transparent in this case. We are certain that they hold for $q\equiv 1\pmod3$, as well. Our opinion is supported by numerical experiments with $q\leq 8$. 

\begin{Lemma} \label{lm:dR-dT}
Assume $q\equiv 2 \pmod3$ and define the $\mathbb{F}_{q^2}$-rational function 
\[T=\frac{1}{3}\left(\frac{\ell_1^{q^2}}{\ell_2} + \frac{\ell_2^{q^2}}{\ell_3} + \frac{\ell_3^{q^2}}{\ell_1}\right).\]
Then
\[d\left(\frac{R}{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-q+1}{3}}}\right) = - \left(\frac{T}{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-q+1}{3}}}\right) dx.\]
\end{Lemma}
\begin{proof}
We have $d\ell_i=(a_i-x)^q dx$, and
\begin{align*}
\ell_i^{q^2}-\ell_{i+1} &= a_i^{q^3}x^{q^2}-y^{q^2}-b_i^{q^3}-(a_{i+1}^{q}x-y-b_{i+1}^{q}) \\
&= a_{i+1}^q(x^{q^2}-x)-(y^{q^2}-y) \\
&= a_{i+1}^q R(x,y) - x^q R(x,y) \\
&= (a_{i+1}-x)^q R(x,y).
\end{align*}
In one line,
\begin{align} \label{eq:ai-x-to-q}
\frac{(a_{i+1}-x))^q}{\ell_{i+1}} = \frac{\ell_1^{q^2}/\ell_2-1}{R(x,y)}.
\end{align}
Hence,
\begin{align*}
d(\ell_1\ell_{2}\ell_{3}) & = \ell_1\ell_{2}\ell_{3} \cdot \left( \frac{(a_1-x)^q}{\ell_1} + \frac{(a_2-x)^q}{\ell_2} + \frac{(a_3-x)^q}{\ell_3}\right)\, dx \\
&= \ell_1\ell_{2}\ell_{3} \cdot \left( \frac{\ell_1^{q^2}/\ell_2-1}{R} + \frac{\ell_2^{q^2}/\ell_3-1}{R} + \frac{\ell_3^{q^2}/\ell_1-1}{R}\right)\, dx \\
&= \frac{\ell_1\ell_{2}\ell_{3}}{R}(3T-3)dx.
\end{align*}
This implies
\begin{multline*}
d\left(R(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-1}{3}}\right) =\left( -(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-1}{3}}\right) dx + \\R \left(-\frac{1}{3}(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-4}{3}}\right) \frac{\ell_1\ell_{2}\ell_{3}}{R}(3T-3)dx.
\end{multline*}
By easy cancellation
\begin{align*}
d\left(R(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-1}{3}}\right) &=\left( -(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-1}{3}}\right) dx + -\frac{1}{3}(\ell_1\ell_{2}\ell_{3})^{\frac{-q^2+q-1}{3}} (3T-3)dx\\
&= - \left(\frac{T}{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-q+1}{3}}}\right) dx. \qedhere
\end{align*}
\end{proof}

\begin{Lemma} \label{lm:tildeD-riemann-roch}
Assume $q\equiv 2 \pmod3$ and define the $\mathbb{F}_{q^2}$-rational functions 
\[T=\frac{1}{3}\left(\frac{\ell_1^{q^2}}{\ell_2} + \frac{\ell_2^{q^2}}{\ell_3} + \frac{\ell_3^{q^2}}{\ell_1}\right) \qquad \text{and} \qquad R_1=\frac{R}{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-q+1}{3}}}.\]
Let $G$ be a divisor of $\mathbb{F}_{q^2}(\mathscr{H}_q)$ whose support is disjoint from the support of $\widetilde{D}$. Then
\[\mathscr{L}(\widetilde{D}-G+(dR_1)-(R_1)) = \mathscr{L}\left( \frac{(q^2-1)(q+1)}{3} P -  G\right) \cdot \frac{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-1}{3}}}{T}.\]
\end{Lemma}
\begin{proof}
We have
\begin{align*}
\widetilde{D}-G+(dR_1)-(R_1) &= \widetilde{D}-G+(T)-\frac{q^2-q+1}{3}(\ell_1\ell_2\ell_3)+(dx) \\
& \qquad -(R)+\frac{q^2-q+1}{3}(\ell_1\ell_2\ell_3) \\
&= \widetilde{D}-G+(T)+(dx)-(R)\\
&= Q_\infty + q^3 Q_\infty +(2\g-2)Q_\infty-G+(T)\\
&= (q^2-1)(q+1)Q_\infty -G+(T)\\
&= \frac{(q^2-1)(q+1)}{3}P-\left((\ell_1\ell_{2}\ell_{3})^{\frac{q^2-1}{3}}\right) -G+(T).
\end{align*}
For the Riemann-Roch spaces, the results follow. 
\end{proof}

\begin{Lemma} \label{lm:elliellj-at-Qinfty}
For any $i,j\in \{1,2,3\}$, we have
\[\left(\frac{\ell_i}{\ell_j}\right)(Q_\infty)=1.\]
\end{Lemma}
\begin{proof}
We use the local expansion $\tau(t)=(t:1:t^{q+1}+\cdots)$ of $\mathscr{H}_q$ at $Q_\infty$. The dots represent terms of higher degree. 
\[\left(\frac{\ell_i}{\ell_j}\right)(\tau(t)) = \frac{a_i^qt -1 -b_i^q(t^{q+1}+\cdots)}{a_j^qt -1 -b_j^q(t^{q+1}+\cdots)},\] 
which implies 
\[\left(\frac{\ell_i}{\ell_j}\right)(Q_\infty) = \left(\frac{\ell_i}{\ell_j}\right)(\tau(0)) =1. \qedhere\]
\end{proof}

\begin{Lemma} \label{lm:T1-at-Qinfty}
Assume $q\not\equiv 0 \pmod3$ and define the $\mathbb{F}_{q^2}$-rational functions 
\[T=\frac{1}{3}\left(\frac{\ell_1^{q^2}}{\ell_2} + \frac{\ell_2^{q^2}}{\ell_3} + \frac{\ell_3^{q^2}}{\ell_1}\right) \qquad \text{and} \qquad T_1=\frac{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-1}{3}}}{T}.\]
Then $T_1(Q_\infty)=1$. 
\end{Lemma}
\begin{proof}
Since 
\[\frac{\ell_i^{q^2}}{\ell_{i+1}(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-1}{3}}}\]
is the product of terms such as $\ell_i/\ell_j$, it takes the value $1$ at $Q_\infty$. This implies $(1/T_1)(Q_\infty)=1$. 
\end{proof}

Before stating our main result on differential codes, we remind the reader that two linear codes $C_1,C_2$ are monomially equivalent, if $C_2=\boldsymbol{\mu} \star C_1$ for some multiplier vector $\boldsymbol{\mu}$. 

\begin{Theorem}
Assume $q\equiv 2 \pmod3$ and define the $\mathbb{F}_{q^2}$-rational functions 
\[T=\frac{1}{3}\left(\frac{\ell_1^{q^2}}{\ell_2} + \frac{\ell_2^{q^2}}{\ell_3} + \frac{\ell_3^{q^2}}{\ell_1}\right) \qquad \text{and} \qquad T_1=\frac{(\ell_1\ell_{2}\ell_{3})^{\frac{q^2-1}{3}}}{T}.\]
Let $G$ be a divisor of $\mathbb{F}_{q^2}(\mathscr{H}_q)$ whose support is disjoint from the support of $\widetilde{D}$. Define $\mu_i=T_1(Q_i)$ for $i \in \{1,\ldots,q^3,\infty\}$, and write $\boldsymbol{\mu}=(\mu_i)$. Then all entries $\mu_i\in \mathbb{F}_{q^2}^*$, and
\[C_\Omega(\widetilde{D},G) = \boldsymbol{\mu} \star C_\mathscr{L}(\widetilde{D},\frac{(q^2-1)(q+1)}{3}P-G).\]
\end{Theorem}
\begin{proof}
If $i\in \{1,\ldots,q^3\}$, then $\ell_i^{q^2}(Q_i)=\ell_{i+1}(Q_i)$. Therefore, $T(Q_i)=1$ and $T_1(Q_i)$ is a well-defined non-zero element in $\mathbb{F}_q$. Lemma \ref{lm:T1-at-Qinfty} implies $T_1(Q_\infty)=1$. The theorem follows from Lemma \ref{lm:tildeD-riemann-roch}. 
\end{proof}

\begin{Corollary}
\[C_\Omega(\widetilde{D},sP) = \boldsymbol{\mu} \star C_\mathcal{L}\left(\widetilde{D},\left(\frac{(q^2-1)(q+1)}{3}-s\right)P\right).\]
\end{Corollary}



%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hermitian subfield subcodes from degree 3 places \label{sec:subf}}

In this section, we study the subfield subcodes of $C_\mathcal{L}(D,sP)$. As before, $q$ is a prime power, $s\geq 0$ integer, and $P$ is a place of degree $3$ of the Hermitian curve $\mathscr{H}_q$. The divisor $D=Q_1+\cdots+Q_{n}$, $n=q^3$, is defined as the sum of the $\mathbb{F}_{q^2}$-rational affine places of $\mathscr{H}_q$. The rational place at infinity is $Q_\infty$ and $\widetilde{D}=D+Q_\infty$. 

\subsection{Trace maps of Hermitian functions and Hermitian codes}
We collect properties of the maps $z\mapsto z^q+z$ and $z\mapsto z^q-z$, where $z$ is either a field element, a function, or a vector. We refer to $z^q+z$ as the trace of $z$, and to the map itself as the trace map $\trace = \trace_{\mathbb{F}_{q^2} / \mathbb{F}_q}$. Clearly, $\trace$ is linear over $\mathbb{F}_q$. 

\begin{Lemma} \label{lm:trace-code-props}
	Consider a positive divisor $G_1$. The trace map satisfies the following properties:
	\begin{enumerate}[label=(\roman*)]
		\item For any function $f \in \mathscr{L}(G_1)$, its trace lies within $\mathscr{L}(qG_1)$, implying $\trace(\mathscr{L}(G_1)) \subseteq \mathscr{L}(qG_1)$.
		\item Similarly, for any codeword $c \in C_{\mathcal{L}}(D,G_1)$, its trace resides in $C_{\mathcal{L}}(D,qG_1)$. 
		\item $\trace(C_{\mathcal{L}}(D,G_1))$ is an $\mathbb{F}_q$-linear subspace of $C_{\mathcal{L}}(D,qG_1) \cap \mathbb{F}_q^n$.
	\end{enumerate}
\end{Lemma}
\begin{proof}
Since $G_1\geq 0$, we have $\mathscr{L}(G_1), \mathscr{L}(G_1)^q \leq \mathscr{L}(qG_1)$, hence (i) holds. (i) implies (ii). (iii) follows trivially.
\end{proof}

\begin{Proposition} \label{pr:trace-subcode}
	Let $G_1$ be a positive divisor that satisfies $\deg G_1 < n/q$. Then $\trace (C_{\mathcal{L}}(D,G_1))$ is an $\mathbb{F}_q$-linear subfield subcode of $C_{\mathcal{L}}(D,qG_1)$. Its dimension is
	\[ \dim_{\mathbb{F}_q}(\trace (C_{\mathcal{L}}(D,G_1)) = 2\dim_{\mathbb{F}_{q^2}}(\mathscr{L}(G_1))-1. \]
\end{Proposition}
\begin{proof}
$\trace (C_{\mathcal{L}}(D,G_1))$ is an $\mathbb{F}_q$-linear subfield subcode by Lemma \ref{lm:trace-code-props}. The trace map $\trace$ and the evaluation map $\ev_D$ commute, and by $\deg(G_1)<n$, $\ev_D$ is injective. Define the $\mathbb{F}_q$-linear map
\[\tau:\mathscr{L}(G_1) \to C_{\mathcal{L}}(D,qG_1) \cap  \mathbb{F}_q^n, \qquad f\mapsto \ev_D(\trace(f)).\]
On the one hand,
\[\dim_{\mathbb{F}_q}(\mathscr{L}(G_1)) = 2\dim_{\mathbb{F}_{q^2}}(\mathscr{L}(G_1)) = \dim \mathrm{Im}(\tau) + \dim \ker(\tau).\]
We have to show that $\ker(\tau)=1$. Define $\varepsilon\in \mathbb{F}_{q^2}$ such that $\varepsilon=1$ if $q$ is even and $\varepsilon=g^{(q+1)/2}$, if $q$ is odd and $g$ is a primitive element in $\mathbb{F}_{q^2}$. Then $\varepsilon^{q-1}=-1$. For the rational function $f\in \mathbb{F}_{q^2}(\mathscr{H}(q))$, we have
\begin{align*}
f\in \ker(\tau) &\Rightarrow f^q+f=0 \\
&\Rightarrow (\varepsilon f)^q=\varepsilon f \\
&\Rightarrow \varepsilon f\in \mathbb{F}_q \\
&\Rightarrow f\in \varepsilon^{-1}\mathbb{F}_q.
\end{align*}
%\begin{align*}
%\trace(u)=u^q+u=0 \Longrightarrow 0 = \varepsilon^q(u^q+u) = (\varepsilon u)^q-(\varepsilon u),
%\end{align*}
%that is, $\varepsilon u \in \mathbb{F}_q^n$. By Proposition \ref{prop:sub}, $C_{\mathcal{L}}(D,G_1)|_{\mathbb{F}_q}$ has dimension $1$, hence the same is true for the kernel of  $\trace: C_{\mathcal{L}}(D,G_1) \to C_{\mathcal{L}}(D,qG_1)$. 
This finishes the proof. 
\end{proof}

\subsection{An explicit subfield subcode}

In this subsection, we study a subfield subcode of $C_\mathcal{L}(D,(q^2-q+1)P)$. As $q^2-q+1=(q-1)(q+1)-(q-1)$, one has
\[U_{q^2-q+1,i} = \frac{\ell_i^q\ell_{i+2}}{\ell_{i+1}\ell_{i+2}^q}.\]
The vector space $\mathcal{W}_{q^2-q+1}\leq \mathscr{L}((q^2-q+1)P)$ consists of the functions
\[W_{q^2-q+1,\alpha} = \alpha \frac{\ell_1^q\ell_3}{\ell_2\ell_3^q} + \alpha^{q^2} \frac{\ell_2^q\ell_1}{\ell_3\ell_1^q} + \alpha^{q^4} \frac{\ell_3^q\ell_2}{\ell_1\ell_2^q}, \qquad \alpha \in \mathbb{F}_{q^6}.\]
For rational functions $f,g\in \mathbb{F}_{q^6}(\mathscr{H}_q)$, we introduce the relation
\[f\approx g \Longleftrightarrow f(Q_i)=g(Q_i) \quad \text{for all $i \in \{1,\ldots,q^3,\infty\}$.}\]
This is clearly an equivalence relation, which can be also written in terms of the principal divisor
\[f\approx g \Longleftrightarrow (f-g) \geq \widetilde{D},\]
or in terms of the evaluation map
\[f\approx g \Longleftrightarrow \ev_{\widetilde{D}}(f) = \ev_{\widetilde{D}}(g).\]

\begin{Lemma} \label{lm:Uq-Wq}
\begin{enumerate}[label=(\roman*)]
%\item $\ell_i^{q^2} \equiv \ell_{i+1}$.
\item $(U_{q^2-q+1,i})^q \approx U_{q^2-q+1,i+2}$.
\item $(W_{q^2-q+1,\alpha})^q \approx W_{q^2-q+1,\alpha^{q^3}}$.
\end{enumerate}
\end{Lemma}
\begin{proof}
Lemma \ref{lm:elliellj-at-Qinfty} implies $U_{q^2-q+1,i}(Q_\infty)=1$. In the proof of Lemma \ref{lm:dR-dT} we have seen that $\ell_i^{q^2} - \ell_{i+1}=(a_{i+1}-x)^qR(x,y)$. Therefore, $(\ell_i^{q^2} - \ell_{i+1})(Q_i)=0$ for all $i\in \{1,\ldots,q^3\}$. This shows 
\begin{align*}
(U_{q^2-q+1,i})^q(Q_i) &= \left(\frac{\ell_i^{q^2}\ell_{i+2}^q}{\ell_{i+1}^q\ell_{i+2}^{q^2}}\right)(Q_i)\\
&=\left(\frac{\ell_{i+1}\ell_{i+2}^q}{\ell_{i+1}^q\ell_{i}}\right)(Q_i)\\
&=U_{q^2-q+1,i+2}(Q_i)
\end{align*}
This proves (i). For (ii):
\begin{align*}
(W_{q^2-q+1,\alpha})^q &= (\alpha U_{q^2-q+1,1} + \alpha^{q^2} U_{q^2-q+1,2} + \alpha^{q^4} U_{q^2-q+1,3})^q \\
&\approx \alpha^q U_{q^2-q+1,3} + \alpha^{q^3} U_{q^2-q+1,1} + \alpha^{q^5} U_{q^2-q+1,2} \\
&=\alpha^{q^3} U_{q^2-q+1,1} + (\alpha^{q^3})^{q^2} U_{q^2-q+1,2} + (\alpha^{q^3})^{q^4} U_{q^2-q+1,3} \\
&=W_{q^2-q+1,\alpha^{q^3}}. \qedhere
\end{align*}
\end{proof}

\begin{Proposition} \label{pr:3-dim-tildeW}
The set 
\[\widetilde{\mathcal{W}} = \{\ev_D(W_{q^2-q+1, \alpha}) \mid \alpha \in \mathbb{F}_{q^3}\}\]
is a $3$-dimensional $\mathbb{F}_q$-linear subfield subcode of $C_\mathcal{L}(D,(q^2-q+1)P)$.
\end{Proposition}
\begin{proof}
Lemma \ref{lm:Uq-Wq}(ii) implies that $\ev_D(W_{q^2-q+1,\alpha})$ has $\mathbb{F}_q$-entries if and only if $\alpha^{q^3}=\alpha$. 
\end{proof}




\subsection{Main result and a conjecture}

\begin{Theorem} \label{th:subcodes-dim}
	Let $q \geq 3$ be a prime power, $n=q^3$, $D=Q_1+\cdots+Q_n$ the sum of rational affine places of $\mathbb{F}_{q^2}(\mathscr{H}_q)$, and $P$ a place of degree $3$. For the dimension of the subfield subcode of the one-point Hermitian code yields
	\[ \dim C_\mathcal{L}(D,sP)|_{\mathbb{F}_q}\geq \begin{cases} 
%		1 & \text { for } 0 \leq s<2\mathfrak{g} \\ 
		7 & \text {for $s=2\mathfrak{g}=q(q-1)$,} \\ 
		10 & \text{for $s=2\g +1=q^2-q+1$.}
	\end{cases}\]
\end{Theorem}
\begin{proof}%[Proof of Theorem \ref{th:subcodes-dim}]
Set $G_1=(q-1)P$. By Proposition \ref{pr:trace-subcode},
\[\mathcal{T}=\ev_D(\trace(\mathscr{L}(G_1)))\]
is an $\mathbb{F}_q$-linear subspace in $C_\mathcal{L}(D,q(q-1)P)|_{\mathbb{F}_q}$. Since $\dim(\mathscr{L}((q-1)P))=4$, $\mathcal{T}$ has dimension $7$. This proves $\dim C_\mathcal{L}(D,q(q-1)P)|_{\mathbb{F}_q}\geq 7$. 

Let $\widetilde{\mathcal{W}}$ the $3$-dimensional $\mathbb{F}_q$-linear subfield subcode of $C_\mathcal{L}(D,(q^2-q+1)P)$ given in Proposition \ref{pr:3-dim-tildeW}. We show that $\mathcal{T} \cap \widetilde{\mathcal{W}} = \{0\}$; the inequality $\dim C_\mathcal{L}(D,(q^2-q+1)P)|_{\mathbb{F}_q}\geq 10$ will follow. On the one hand, 
\[\widetilde{\mathcal{W}}\leq \ev_D(\mathcal{W}_{q^2-q+1}).\] 
On the other hand, using Theorem \ref{th:Wt-props}, we have
\[\mathcal{T} \leq \ev_D(\mathscr{L}(q(q-1)P)) = \ev_D\left( \bigoplus_{t\in H(P), \, t\leq q(q-1)} \mathcal{W}_t \right).\]
As $\ev_D$ is injective on $\mathscr{L}((q^2-q+1)P)$, and
\[\left( \bigoplus_{t\in H(P), \, t\leq q(q-1)} \mathcal{W}_t \right) \cap \mathcal{W}_{q^2-q+1}=\{0\},\]
we obtain $\mathcal{T} \cap \widetilde{\mathcal{W}} = \{0\}$. This completes the proof.
\end{proof}

Our proof was constructive, we used the subfield subcodes given explicitly in the previous subsections. Based on computer calculations for small $q$, we have the following conjecture. 

\begin{Conjecture} 
	If $q\geq 4$, then equalities hold in Theorem \ref{th:subcodes-dim}.
\end{Conjecture}

The claim of the conjecture has some equivalent formulations.

\begin{Proposition} \label{pr:equivalents}
The following are equivalent.
\begin{enumerate}[label=(\roman*)]
\item $\dim C_\mathcal{L}(D,(q^2-q)P)|_{\mathbb{F}_q}=7$.
\item $\dim C_\mathcal{L}(D,(q^2-q-1)P)|_{\mathbb{F}_q}=1$.
\item $\dim C_\mathcal{L}(D,sP)|_{\mathbb{F}_q}=1$ for all $0\leq s\leq 2\g-1=q^2-q-1$.
\end{enumerate}
\end{Proposition}
\begin{proof}
We use the notation of the proof of Theorem \ref{th:subcodes-dim}. Assume (i). We have $\mathscr{L}((q-1)P)=\mathcal{W}_0\oplus \mathcal{W}_{q-1}$. Moreover, $\mathcal{T}$ is an $\mathbb{F}_q \mathcal{B}$-module that decomposes into the direct sum of a $1$-dimensional submodule and a $6$-dimensional submodule. Notice that any non-trivial irreducible $\mathbb{F}_q \mathcal{B}$-module has dimension $6$. Since $\mathcal{T}\cap C_\mathcal{L}(D,(q^2-q-1)P)$ is a proper submodule, the only possibility is that it is $1$-dimensional over $\mathbb{F}_q$. (ii) follows. Trivially, (ii) implies (iii). Let us now assume (iii).
\[\dim_{\mathbb{F}_q} C_\mathcal{L}(D,(q^2-q)P) / C_\mathcal{L}(D,(q^2-q-1)P) = 6,\]
therefore,
\[\dim_{\mathbb{F}_q} C_\mathcal{L}(D,(q^2-q)P)|_{\mathbb{F}_q} / C_\mathcal{L}(D,(q^2-q-1)P)|_{\mathbb{F}_q} \leq 6.\]
This implies $\dim C_\mathcal{L}(D,(q^2-q)P)|_{\mathbb{F}_q} \leq 7$. Together with Theorem \ref{th:subcodes-dim}, we have (i). 
\end{proof}

We have a partial result related to case (iii) of Proposition \ref{pr:equivalents}.

\begin{Proposition}
$\dim C_\mathcal{L}(D,sP)|_{\mathbb{F}_q}=1$ for all $0\leq s\leq \frac{2}{3}\g$.
\end{Proposition}
\begin{proof}
Fix an arbitrary integer $s$ in the range $0 \leq s <\frac{2}{3}\g$ and consider a generic element $(c_1,\ldots,c_{q^3}) \in C_{q}(s)$. This corresponds to a function $g$ in $\mathscr{L}(sP)$ such that $c_i=g(Q_i)$ is an element of $\mathbb{F}_q$ for each $i=1,\ldots,q^3$. We note that there exists a $\gamma \in \mathbb{F}_q$ such that at least $q^2$ of the $c_i$ values are equal to $\gamma$. In other words, the function $g-\gamma$ is in $\mathscr{L}(sP)$ and has at least $q^2$ zeros on $\mathscr{H}_q$. However, a non-zero function in $\mathscr{L}(sP)$ cannot have more than $\deg(G)\leq 2\g = q(q-1)$ zeros, leading us to conclude that $g-\gamma$ must be the zero function. This implies that every $c_i$ is equal to $\gamma$, and hence $C_\mathcal{L}(D,sP)|_{\mathbb{F}_q}$ consists of constant vectors. This completes the proof.
\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	\acknowledgments{The first author acknowledges support from the French government Investissements d’Avenir program ANR-11-LABX-0020-01. Additionally, a part of this work was funded by the French National Research Agency through ANR Barracuda (ANR-21-CE39-0009). The second author... }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\reftitle{References}

% Please provide either the correct journal abbreviation (e.g. according to the “List of Title Word Abbreviations” http://www.issn.org/services/online-services/access-to-the-ltwa/) or the full name of the journal.
% Citations and References in Supplementary files are permitted provided that they also appear in the reference list here. 

%=====================================
% References, variant A: external bibliography
%=====================================
\bibliography{hermitian}

\end{document}

